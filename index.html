<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>P2P Tutoring Platform</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    :root {
      --primary-blue: #004aad;
      --secondary-orange: #f28b30;
      --dark-blue: #002454;
      --darker-blue: rgba(3, 0, 48, 0.7);
      --light-grey: #f4f4f4;
      --white: #ffffff;
      --text-color: #333;
      --box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      --transition-speed: 0.3s ease;
    }

    body {
      font-family: 'Poppins', sans-serif; /* Changed font to Poppins for modern look */
      margin: 0;
      padding: 0;
      background:
        url('assets/image.png') no-repeat center top / cover, /* Adjusted background properties */
        linear-gradient(to bottom, transparent 60%, var(--primary-blue) 100%);
      background-attachment: fixed;
      min-height: 100vh;
      color: var(--white);
      overflow-x: hidden; /* Prevent horizontal scroll due to animations */
    }

    /* General Animations */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes slideInDown {
      from { transform: translateY(-50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    @keyframes slideInUp {
      from { transform: translateY(50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    @keyframes popIn {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    header {
      background-color: var(--darker-blue);
      padding: 40px 20px;
      text-align: center;
      border-bottom: 5px solid var(--secondary-orange);
      animation: fadeIn 1s ease-out;
    }

    header img {
      max-width: 120px; /* Slightly larger logo */
      display: block;
      margin: 0 auto 20px;
      animation: slideInDown 0.8s ease-out;
    }

    header h1 {
      font-size: 42px; /* Larger heading */
      color: var(--secondary-orange);
      text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.6);
      margin-bottom: 10px;
      animation: slideInDown 1s ease-out;
    }

    header p {
      font-size: 22px;
      color: var(--secondary-orange);
      animation: slideInDown 1.2s ease-out;
    }

    nav {
      background-color: var(--dark-blue);
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    }

    nav a {
      color: var(--white);
      text-decoration: none;
      padding: 18px 25px; /* More padding for nav links */
      font-size: 19px;
      font-weight: bold;
      text-transform: uppercase;
      transition: background-color var(--transition-speed), color var(--transition-speed), transform var(--transition-speed);
    }

    nav a:hover {
      background-color: var(--secondary-orange);
      color: var(--dark-blue);
      transform: translateY(-3px); /* Slight lift on hover */
    }

    main {
      padding: 40px;
      background-color: rgba(244, 244, 244, 0.9); /* Slightly less transparent */
      min-height: 80vh;
      color: var(--text-color);
      box-shadow: inset 0 5px 15px rgba(0, 0, 0, 0.05); /* Inner shadow for depth */
    }

    section {
      margin-bottom: 40px; /* More space between sections */
      padding: 35px;
      background-color: var(--white);
      border-radius: 12px;
      box-shadow: var(--box-shadow);
      opacity: 0; /* Hidden by default, animated by JS */
      transform: translateY(20px); /* Slightly below, animated by JS */
      transition: opacity 0.6s ease-out, transform 0.6s ease-out;
    }

    section.animate-in {
      opacity: 1;
      transform: translateY(0);
    }

    h2 {
      font-size: 32px;
      color: var(--primary-blue);
      margin-bottom: 25px;
      text-align: center;
      position: relative;
    }

    h2::after {
      content: '';
      display: block;
      width: 60px;
      height: 4px;
      background: var(--secondary-orange);
      margin: 10px auto 0;
      border-radius: 2px;
    }

    .subject-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); /* Slightly larger min-width */
      gap: 30px;
    }

    .subject, .classes {
      color: var(--white);
      padding: 25px;
      border-radius: 10px;
      text-align: center;
      cursor: default;
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15); /* Stronger shadow */
      transition: box-shadow var(--transition-speed), transform var(--transition-speed), background-color var(--transition-speed);
      opacity: 0; /* Hidden by default, animated by JS */
      transform: scale(0.9); /* Smaller, animated by JS */
    }

    .subject {
      background-color: var(--secondary-orange);
    }

    .classes {
      background-color: var(--primary-blue);
    }

    .subject.animate-in, .classes.animate-in {
        animation: popIn 0.5s ease-out forwards; /* Applied by JS with staggered delay */
    }

    .subject:hover {
      box-shadow: 0 8px 20px rgba(242, 139, 48, 0.5); /* Enhanced glow */
      transform: translateY(-5px) scale(1.02); /* Lift and slight scale */
      background-color: #e07a21; /* Slightly darker orange */
    }

    .classes:hover {
      box-shadow: 0 8px 20px rgba(0, 74, 173, 0.5); /* Enhanced glow */
      transform: translateY(-5px) scale(1.02); /* Lift and slight scale */
      background-color: #003a8d; /* Slightly darker blue */
    }

    .button {
      display: block;
      width: fit-content; /* Adjust width to content */
      margin: 30px auto 0; /* Center button with more margin */
      padding: 16px 30px;
      background-color: var(--primary-blue);
      color: var(--white);
      border: none;
      border-radius: 8px; /* Slightly more rounded */
      font-size: 20px;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      transition: background-color var(--transition-speed), transform var(--transition-speed), box-shadow var(--transition-speed);
    }

    .button:hover {
      background-color: var(--secondary-orange);
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
    }

    #self-learning p,
    #self-learning ul {
      color: var(--dark-blue);
      line-height: 1.7; /* Better readability */
      font-size: 17px;
    }

    #self-learning a {
        color: var(--secondary-orange);
        font-weight: bold;
        text-decoration: none;
        transition: color var(--transition-speed);
    }
    #self-learning a:hover {
        color: var(--primary-blue);
        text-decoration: underline;
    }

    #self-learning ul {
        list-style: disc; /* Ensure bullet points */
        padding-left: 25px;
    }

    #self-learning li {
        margin-bottom: 8px;
    }

    footer {
      background-color: var(--primary-blue);
      padding: 25px;
      text-align: center;
      color: var(--white);
      font-size: 16px;
      box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
    }

    footer a {
      color: var(--secondary-orange);
      text-decoration: none;
      font-weight: bold;
      transition: text-decoration var(--transition-speed), color var(--transition-speed);
    }

    footer a:hover {
      text-decoration: underline;
      color: var(--white);
    }

    /* Floating Buttons */
    .floating-btn {
      position: fixed;
      bottom: 25px;
      right: 25px;
      background-color: var(--primary-blue);
      color: var(--white);
      border: none;
      border-radius: 50%;
      width: 55px; /* Slightly larger */
      height: 55px;
      font-size: 24px; /* Larger icon */
      cursor: pointer;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color var(--transition-speed), transform var(--transition-speed), box-shadow var(--transition-speed);
    }

    .floating-btn:hover {
      background-color: var(--secondary-orange);
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
    }

    #music-btn {
      bottom: 25px;
      right: 25px;
    }

    #ai-btn {
      bottom: 90px; /* Position above music button */
      right: 25px;
      font-size: 28px; /* Slightly larger AI icon */
    }

    /* AI Chatbot Container */
    .ai-chatbot-container {
      position: fixed;
      bottom: 20px;
      right: 90px;
      width: 380px; /* Slightly wider */
      height: 520px; /* Slightly taller */
      background-color: var(--white);
      border-radius: 15px; /* More rounded corners */
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25); /* Stronger shadow */
      display: flex;
      flex-direction: column;
      overflow: hidden;
      z-index: 998;
      transform: scale(0.5); /* Starts smaller */
      opacity: 0; /* Starts hidden */
      transform-origin: bottom right;
      transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55), /* Springy transition */
                  opacity 0.4s ease-out,
                  width 0.3s ease, height 0.3s ease,
                  top 0.3s ease, right 0.3s ease, bottom 0.3s ease, left 0.3s ease;
    }

    .ai-chatbot-container.active {
      transform: scale(1);
      opacity: 1;
    }

    /* Full-screen mode for chatbot */
    .ai-chatbot-container.fullscreen {
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      width: 100vw;
      height: 100vh;
      border-radius: 0;
      transform: scale(1);
      opacity: 1;
      z-index: 1001;
    }

    .ai-chatbot-header {
      background-color: var(--primary-blue);
      color: var(--white);
      padding: 18px 20px; /* More padding */
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 20px; /* Larger header text */
      font-weight: bold;
      border-top-left-radius: 15px;
      border-top-right-radius: 15px;
      flex-shrink: 0; /* Prevent header from shrinking */
    }

    .ai-chatbot-container.fullscreen .ai-chatbot-header {
      border-radius: 0;
    }

    .ai-chatbot-header .header-controls {
        display: flex;
        gap: 12px; /* More space between buttons */
    }

    .ai-chatbot-header button {
      background: none;
      border: none;
      color: var(--white);
      font-size: 26px; /* Larger control icons */
      cursor: pointer;
      line-height: 1;
      transition: color var(--transition-speed), transform var(--transition-speed);
    }
    .ai-chatbot-header button:hover {
        color: var(--secondary-orange);
        transform: scale(1.1);
    }

    .ai-chatbot-messages {
      flex-grow: 1;
      padding: 20px;
      overflow-y: auto;
      background-color: #f9f9f9;
      color: var(--text-color);
      display: flex;
      flex-direction: column; /* Ensure messages stack vertically */
    }

    .ai-chatbot-message {
      margin-bottom: 12px; /* More space between messages */
      padding: 10px 15px;
      border-radius: 20px; /* More rounded messages */
      max-width: 85%; /* Slightly wider max-width */
      position: relative;
      animation: fadeIn 0.3s ease-out, slideInUp 0.3s ease-out; /* Animation for new messages */
    }

    .ai-chatbot-message.user {
      background-color: #e0e0e0;
      align-self: flex-end;
      margin-left: auto;
      border-bottom-right-radius: 5px; /* Tail effect */
    }

    .ai-chatbot-message.bot {
      background-color: #d1e7dd;
      align-self: flex-start;
      margin-right: auto;
      display: flex;
      flex-direction: column;
      padding-right: 40px; /* Space for the icon */
      border-bottom-left-radius: 5px; /* Tail effect */
    }

    .ai-chatbot-message.bot .message-text-content {
        flex-grow: 1;
        font-size: 16px;
    }

    .ai-chatbot-message.bot .speaker-icon {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
        color: #888;
        font-size: 1.1em;
        transition: color 0.2s ease-in-out, transform 0.2s ease;
    }
    .ai-chatbot-message.bot .speaker-icon:hover {
        color: var(--primary-blue);
        transform: translateY(-50%) scale(1.15);
    }
    .ai-chatbot-message.bot .speaker-icon:active {
        transform: translateY(-50%) scale(0.95);
    }

    /* Typing indicator */
    .ai-chatbot-message.typing-indicator {
        background-color: #e0e0e0;
        display: flex;
        gap: 4px;
        padding: 10px 15px;
        width: fit-content;
        align-items: center;
    }
    .ai-chatbot-message.typing-indicator span {
        width: 8px;
        height: 8px;
        background-color: #888;
        border-radius: 50%;
        animation: bounce 1.4s infinite ease-in-out;
    }
    .ai-chatbot-message.typing-indicator span:nth-child(2) {
        animation-delay: 0.2s;
    }
    .ai-chatbot-message.typing-indicator span:nth-child(3) {
        animation-delay: 0.4s;
    }
    @keyframes bounce {
        0%, 80%, 100% { transform: scale(0); }
        40% { transform: scale(1); }
    }


    .ai-chatbot-predefined-questions {
      padding: 15px 20px;
      border-top: 1px solid #eee;
      background-color: #f1f1f1;
      display: flex;
      flex-wrap: wrap;
      gap: 10px; /* More space between buttons */
      max-height: 180px; /* Increased max-height */
      overflow-y: auto;
      scrollbar-width: thin; /* Firefox scrollbar */
      scrollbar-color: var(--secondary-orange) #f1f1f1; /* Firefox scrollbar color */
      flex-shrink: 0; /* Prevent from shrinking */
    }

    /* Webkit scrollbar styles */
    .ai-chatbot-predefined-questions::-webkit-scrollbar {
        width: 8px;
    }
    .ai-chatbot-predefined-questions::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 10px;
    }
    .ai-chatbot-predefined-questions::-webkit-scrollbar-thumb {
        background-color: var(--secondary-orange);
        border-radius: 10px;
        border: 2px solid #f1f1f1;
    }
    .ai-chatbot-predefined-questions::-webkit-scrollbar-thumb:hover {
        background-color: #e07a21;
    }


    .ai-chatbot-predefined-questions button {
      background-color: var(--secondary-orange);
      color: var(--white);
      border: none;
      border-radius: 25px; /* More rounded pills */
      padding: 10px 18px; /* More padding */
      cursor: pointer;
      font-size: 15px;
      transition: background-color 0.2s, transform 0.1s;
      flex-shrink: 0; /* Prevent buttons from shrinking too much */
      animation: fadeIn 0.4s ease-out; /* Fade in effect */
    }

    .ai-chatbot-predefined-questions button:hover {
      background-color: #e07a21;
      transform: translateY(-2px);
    }
    .ai-chatbot-predefined-questions button:active {
        transform: translateY(0);
    }

    /* Poppins Font Import */
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap');
  </style>
</head>
<body>

  <header>
    <img src="assets/logo.png" alt="Platform Logo">
    <h1>P2P Tutoring Platform</h1>
    <p>Empowering students to learn, grow, and succeed together.</p>
  </header>

  <nav>
    <a href="#subjects">Subjects</a>
    <a href="#classes">Classes</a>
    <a href="#self-learning">Self-Learning</a>
  </nav>

  <main>
    <section id="subjects">
      <h2>Core Subjects</h2>
      <div class="subject-grid">
        <div class="subject">Math</div>
        <div class="subject">Science</div>
        <div class="subject">IT</div>
        <div class="subject">Social Sciences</div>
      </div>
    </section>

    <section id="classes">
      <h2>Classes Covered</h2>
      <div class="subject-grid">
        <div class="classes">1st</div>
        <div class="classes">2nd</div>
        <div class="classes">3rd</div>
        <div class="classes">4th</div>
        <div class="classes">5th</div>
        <div class="classes">6th</div>
        <div class="classes">7th</div>
        <div class="classes">8th</div>
      </div>
    </section>

    <section id="self-learning">
      <h2>Encouraging Self-Learning</h2>
      <p><a href="https://www.youtube.com/@RiSync" target="_blank">Learn more from RiSync</a></p>
      <p>Our platform provides tools and resources to help students take charge of their learning journey. Features include:</p>
      <ul>
        <li>Interactive quizzes to test knowledge.</li>
        <li>Resource libraries for deeper subject understanding.</li>
        <li>Discussion forums to share and exchange ideas.</li>
        <li>Personalized learning paths based on student goals.</li>
      </ul>
    </section>

    <button class="button" onclick="window.open('html/signin.html', '_blank')">Sign In</button>
  </main>

  <footer>
    <p>© 2025 P2P Tutoring Platform. All rights reserved.</p>
    <p><a href="Terms of Service.html" target="_blank">Terms of Service</a> | <a href="Privacy Policy.html" target="_blank">Privacy Policy</a></p>
  </footer>

  <audio id="bg-music" loop preload="auto">
    <source src="assets/logo.mp3" type="audio/mpeg">
    Your browser does not support the audio element.
  </audio>

  <button id="music-btn" class="floating-btn" onclick="toggleMusic()" title="Toggle Music">
    <i class="fas fa-volume-mute"></i>
  </button>

  <button id="ai-btn" class="floating-btn" onclick="toggleAIChat()" title="Ask AI">
    <i class="fas fa-brain"></i>
  </button>

  <div class="ai-chatbot-container" id="ai-chatbot-container">
    <div class="ai-chatbot-header">
      <span>RiBot</span>
      <div class="header-controls">
        <button id="fullscreen-btn" onclick="toggleFullscreen()" title="Toggle Fullscreen">
            <i class="fas fa-expand-alt"></i>
        </button>
        <button class="close-btn" onclick="toggleAIChat()" title="Close Chat">
            <i class="fas fa-times"></i>
        </button>
      </div>
    </div>
    <div class="ai-chatbot-messages" id="ai-chatbot-messages">
      <div class="ai-chatbot-message bot">
        <span class="message-text-content">Hello! I'm RiBot, your intelligent learning assistant. How can I help you today?</span>
        <i class="fas fa-volume-up speaker-icon" title="Read aloud" aria-label="Read message aloud"></i>
      </div>
    </div>
    <div class="ai-chatbot-predefined-questions" id="ai-chatbot-predefined-questions">
      </div>
  </div>

  <script>
    const audio = document.getElementById('bg-music');
    const musicButton = document.getElementById('music-btn');
    let hasInteracted = false;

    function toggleMusic() {
      if (!hasInteracted) {
        audio.volume = 0.5;
        audio.play().then(() => {
          hasInteracted = true;
          updateMusicIcon();
        }).catch(err => {
          console.warn("Autoplay blocked or failed:", err);
        });
      } else {
        if (audio.paused) {
          audio.play();
        } else {
          audio.pause();
        }
      }
      updateMusicIcon();
    }

    function updateMusicIcon() {
      if (!musicButton) return;
      musicButton.innerHTML = audio.paused ? '<i class="fas fa-volume-mute"></i>' : '<i class="fas fa-volume-up"></i>';
    }

    audio.onplay = updateMusicIcon;
    audio.onpause = updateMusicIcon;

    // AI Chatbot Script
    const aiChatbotContainer = document.getElementById('ai-chatbot-container');
    const aiChatbotMessages = document.getElementById('ai-chatbot-messages');
    const predefinedQuestionsDiv = document.getElementById('ai-chatbot-predefined-questions');
    const fullscreenBtn = document.getElementById('fullscreen-btn');

    let currentUtterance = null;
    let currentSpeakerIcon = null;
    let selectedVoice = null;

    function initializeSpeechSynthesis() {
        if ('speechSynthesis' in window) {
            speechSynthesis.onvoiceschanged = () => {
                selectedVoice = getHumanLikeVoice();
                if (!selectedVoice) {
                    console.warn("No suitable speech synthesis voice found. Using default or no voice if none available.");
                } else {
                    console.log("Selected voice for speech synthesis:", selectedVoice.name);
                }
            };
            // Call immediately if voices are already loaded (e.g., page reloaded)
            if (speechSynthesis.getVoices().length > 0) {
                selectedVoice = getHumanLikeVoice();
            }
        } else {
            console.warn("Web Speech API not supported in this browser.");
        }
    }

    function getHumanLikeVoice() {
        const voices = speechSynthesis.getVoices();
        let chosenVoice = null;
        // Prioritize Google US English
        chosenVoice = voices.find(voice => voice.lang === 'en-US' && voice.name.includes('Google US English'));
        if (chosenVoice) return chosenVoice;
        // Then any Google or Microsoft English voice
        chosenVoice = voices.find(voice => voice.lang.startsWith('en-') && (voice.name.includes('Google') || voice.name.includes('Microsoft')));
        if (chosenVoice) return chosenVoice;
        // Fallback to any English voice
        chosenVoice = voices.find(voice => voice.lang.startsWith('en-'));
        if (chosenVoice) return chosenVoice;
        // Finally, the first available voice
        return voices[0] || null;
    }

    function stopSpeaking(iconElement, originalTextContent) {
        if ('speechSynthesis' in window && window.speechSynthesis.speaking) {
            window.speechSynthesis.cancel();
        }
        if (iconElement && iconElement === currentSpeakerIcon) {
            iconElement.className = 'fas fa-volume-up speaker-icon';
            iconElement.onclick = () => speakText(originalTextContent, iconElement);
        }
        currentUtterance = null;
        currentSpeakerIcon = null;
    }

    function speakText(text, iconElement) {
        if (!('speechSynthesis' in window)) {
            console.warn("Web Speech API not supported.");
            return;
        }

        if (window.speechSynthesis.speaking) {
            // Get the text content of the currently speaking message to restore its icon
            const previouslySpeakingIconText = currentSpeakerIcon ? (currentSpeakerIcon.closest('.ai-chatbot-message')?.querySelector('.message-text-content')?.textContent || '') : '';
            stopSpeaking(currentSpeakerIcon, previouslySpeakingIconText);
        }

        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'en-US';
        if (selectedVoice) {
            utterance.voice = selectedVoice;
        }

        currentUtterance = utterance;
        currentSpeakerIcon = iconElement;

        if (iconElement) {
            iconElement.className = 'fas fa-volume-mute speaker-icon';
            iconElement.onclick = () => stopSpeaking(iconElement, text);
        }

        utterance.onend = () => stopSpeaking(iconElement, text);
        utterance.oncancel = () => stopSpeaking(iconElement, text);
        utterance.onerror = (event) => {
            console.error('Speech synthesis error:', event.error);
            stopSpeaking(iconElement, text);
        };

        window.speechSynthesis.speak(utterance);
    }

    const predefinedQuestions = [
      { id: 'tutoring', text: 'What is Intelligent Peer-to-Peer Tutoring?', answer: 'It\'s a smart platform where students learn from each other, with AI matching them based on skill, topic, and availability. It builds community, boosts confidence, and is more relatable than adult tutors.' },
      { id: 'booking', text: 'How does the Booking System work?', answer: 'It allows students to book live 1-on-1 or group tutoring sessions with calendar integration to avoid double bookings. You choose a subject, select a time, confirm, and get reminders.' },
      { id: 'live_sessions', text: 'Tell me about Live Tutoring Sessions.', answer: 'These are real-time sessions with an optional live video/audio and a collaborative digital whiteboard. It feels like a real classroom and is ideal for explaining Maths, Diagrams, and Flowcharts.' },
      { id: 'chatbot', text: 'What is RiBot?', answer: 'RiBot is an intelligent chatbot that answers any questions students have and supports group chatrooms. It\'s a 24x7 learning assistant, can be multilingual, supports text-to-speech/speech-to-text, and can quiz kids with MCQs or riddles.' },
      { id: 'resources', text: 'What is the Learning Resource Library?', answer: 'It\'s a growing bank of curated notes, worksheets, videos, quizzes, and more, created by students, for students. Resources are divided by subjects, grades, difficulty, and are downloadable.' },
      { id: 'gamification', text: 'How does Gamification work?', answer: 'It adds fun through points, badges, levels, and leaderboards to keep students motivated and foster friendly competition. Examples include earning points for solving doubts or badges for "Top Tutor of the Week".' },
      { id: 'quizzes', text: 'What is the Smart Quiz & Assessment Builder?', answer: 'Teachers or mentors can create dynamic quizzes, and AI can auto-generate questions. It allows for personalized learning with adaptive difficulty, featuring MCQs, drag & drop, timed quizzes, and instant feedback.' },
      { id: 'accessibility', text: 'What about Accessibility Features?', answer: 'The platform is designed for inclusivity, supporting students with visual, hearing, or motor challenges. It includes text-to-speech, Braille-compatible output, high contrast mode, font sizing, and keyboard-only navigation.' },
      { id: 'parental_dashboard', text: 'Is there a Parental Dashboard?', answer: 'Yes, parents can view their child’s progress, session history, and scores without micro-managing. It provides growth charts, areas of concern, weekly email reports, and options to message tutors.' },
      { id: 'admin_panel', text: 'What is the Admin & Mentor Panel?', answer: 'This panel is for the RiSync team or appointed mentors to moderate, analyze, and grow the platform, ensuring community safety. It allows approval/rejection of uploads, blocking users, and access to analytics.' },
      { id: 'sync', text: 'Does it sync with mobile?', answer: 'RiSync works as a responsive web app and can sync with mobile devices for learning on the go, with cross-device sync, notifications, and offline access coming soon.' },
      { id: 'future_roadmap', text: 'What\'s in the future roadmap?', answer: 'Future plans include AI-based learning path recommendations, global collaborations, story-based learning, and NGO/School Partnerships for underprivileged learners.' }
    ];

    function toggleAIChat() {
      aiChatbotContainer.classList.toggle('active');
      if (aiChatbotContainer.classList.contains('active')) {
        // Clear previous messages except the initial greeting
        aiChatbotMessages.innerHTML = `
            <div class="ai-chatbot-message bot">
                <span class="message-text-content">Hello! I'm RiBot, your intelligent learning assistant. How can I help you today?</span>
                <i class="fas fa-volume-up speaker-icon" title="Read aloud" aria-label="Read message aloud"></i>
            </div>
        `;
        // Re-attach event listener for the initial greeting's speaker icon
        const initialBotMessage = aiChatbotMessages.querySelector('.ai-chatbot-message.bot');
        const initialTextContent = initialBotMessage.querySelector('.message-text-content').textContent;
        const initialSpeakerIcon = initialBotMessage.querySelector('.speaker-icon');
        if (initialSpeakerIcon && initialTextContent) {
            initialSpeakerIcon.onclick = () => speakText(initialTextContent, initialSpeakerIcon);
        }

        populatePredefinedQuestions();
        aiChatbotMessages.scrollTop = aiChatbotMessages.scrollHeight; // Scroll to bottom
      } else {
        stopSpeaking(currentSpeakerIcon, ''); // Stop speaking when chatbot is closed
        // If chatbot is closed, ensure it's not in fullscreen mode
        if (aiChatbotContainer.classList.contains('fullscreen')) {
            toggleFullscreen();
        }
      }
    }

    function populatePredefinedQuestions() {
      predefinedQuestionsDiv.innerHTML = ''; // Clear previous questions
      predefinedQuestions.forEach((q, index) => {
        const button = document.createElement('button');
        button.textContent = q.text;
        button.onclick = () => askQuestion(q.id);
        button.style.animationDelay = `${0.1 * index}s`; // Stagger animation for buttons
        predefinedQuestionsDiv.appendChild(button);
      });
    }

    function askQuestion(questionId) {
      stopSpeaking(currentSpeakerIcon, ''); // Stop speaking when a new question is asked

      const question = predefinedQuestions.find(q => q.id === questionId);
      if (question) {
        // Add user's question to chat
        const userMessage = document.createElement('div');
        userMessage.classList.add('ai-chatbot-message', 'user');
        userMessage.textContent = question.text;
        aiChatbotMessages.appendChild(userMessage);
        aiChatbotMessages.scrollTop = aiChatbotMessages.scrollHeight;

        // Simulate RiBot typing/thinking
        const typingIndicator = document.createElement('div');
        typingIndicator.classList.add('ai-chatbot-message', 'bot', 'typing-indicator');
        typingIndicator.innerHTML = '<span></span><span></span><span></span>';
        aiChatbotMessages.appendChild(typingIndicator);
        aiChatbotMessages.scrollTop = aiChatbotMessages.scrollHeight;

        setTimeout(() => {
          // Remove typing indicator
          if (aiChatbotMessages.contains(typingIndicator)) {
            aiChatbotMessages.removeChild(typingIndicator);
          }

          // Add RiBot's answer to chat
          const botMessage = document.createElement('div');
          botMessage.classList.add('ai-chatbot-message', 'bot');

          const textContentSpan = document.createElement('span');
          textContentSpan.classList.add('message-text-content');
          textContentSpan.innerHTML = question.answer;
          botMessage.appendChild(textContentSpan);

          const speakerIcon = document.createElement('i');
          speakerIcon.className = 'fas fa-volume-up speaker-icon';
          speakerIcon.title = 'Read aloud';
          speakerIcon.setAttribute('aria-label', 'Read message aloud');
          speakerIcon.onclick = () => speakText(textContentSpan.textContent, speakerIcon);
          botMessage.appendChild(speakerIcon);

          aiChatbotMessages.appendChild(botMessage);
          aiChatbotMessages.scrollTop = aiChatbotMessages.scrollHeight; // Scroll to bottom
        }, 1200); // Simulate 1.2 second delay for bot response for typing animation
      }
    }

    function toggleFullscreen() {
        if (!document.fullscreenElement) {
            if (aiChatbotContainer.requestFullscreen) {
                aiChatbotContainer.requestFullscreen();
            } else if (aiChatbotContainer.webkitRequestFullscreen) { /* Safari */
                aiChatbotContainer.webkitRequestFullscreen();
            } else if (aiChatbotContainer.msRequestFullscreen) { /* IE11 */
                aiChatbotContainer.msRequestFullscreen();
            }
        } else {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.webkitExitFullscreen) { /* Safari */
                document.webkitExitFullscreen();
            } else if (document.msExitFullscreen) { /* IE11 */
                document.msExitFullscreen();
            }
        }
        // Class will be toggled by the 'fullscreenchange' event listener
    }

    // Event listener for native fullscreen change (e.g., when user presses F11 or Esc)
    document.addEventListener('fullscreenchange', updateFullscreenButtonIcon);
    document.addEventListener('webkitfullscreenchange', updateFullscreenButtonIcon);
    document.addEventListener('msfullscreenchange', updateFullscreenButtonIcon);

    function updateFullscreenButtonIcon() {
        if (document.fullscreenElement || document.webkitFullscreenElement || document.msFullscreenElement) {
            fullscreenBtn.innerHTML = '<i class="fas fa-compress-alt"></i>'; // Change to exit fullscreen icon
            fullscreenBtn.title = 'Exit Fullscreen';
            aiChatbotContainer.classList.add('fullscreen'); // Ensure class is added if fullscreen was triggered externally
        } else {
            fullscreenBtn.innerHTML = '<i class="fas fa-expand-alt"></i>'; // Change to enter fullscreen icon
            fullscreenBtn.title = 'Toggle Fullscreen';
            aiChatbotContainer.classList.remove('fullscreen'); // Ensure class is removed
        }
    }

    // Intersection Observer for section animations
    const sections = document.querySelectorAll('section');

    const sectionObserver = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('animate-in');
          const gridItems = entry.target.querySelectorAll('.subject, .classes');
          gridItems.forEach((item, index) => {
            item.style.animationDelay = `${0.1 * index + 0.3}s`; // Stagger delay for grid items
            item.classList.add('animate-in'); // Trigger popIn animation
          });
          observer.unobserve(entry.target); // Unobserve once animated
        }
      });
    }, {
      threshold: 0.1, // Trigger when 10% of the section is visible
      rootMargin: "0px 0px -50px 0px" // Adjust to trigger slightly sooner or later
    });

    sections.forEach(section => {
      sectionObserver.observe(section);
    });


    // Initialize speech synthesis and predefined questions when the page loads
    document.addEventListener('DOMContentLoaded', () => {
        initializeSpeechSynthesis();
        populatePredefinedQuestions();

        // Re-attach event listener for the initial greeting's speaker icon on load
        const initialBotMessage = aiChatbotMessages.querySelector('.ai-chatbot-message.bot');
        const initialTextContent = initialBotMessage.querySelector('.message-text-content').textContent;
        const initialSpeakerIcon = initialBotMessage.querySelector('.speaker-icon');
        if (initialSpeakerIcon && initialTextContent) {
            initialSpeakerIcon.onclick = () => speakText(initialTextContent, initialSpeakerIcon);
        }

        updateFullscreenButtonIcon(); // Set initial icon for fullscreen button
    });
  </script>
</body>
</html>